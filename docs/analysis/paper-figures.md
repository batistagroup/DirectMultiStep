# Paper Figures

This document describes the figures that can be generated using the `paper-figures.py` script.

## Available Figures

### 1. Route Length Distribution

- **File**: `route_length_distribution.{pdf,html}`
- **Description**: Visualizes the distribution of route lengths across different datasets (training, n1, and n5 datasets).
- **Generated by**: `plot_route_length_distribution()`

### 2. Leaf Distribution

- **File**: `leaf_distribution.{pdf,html}`
- **Description**: Shows the distribution of leaf nodes (end states) across different datasets.
- **Generated by**: `plot_leaf_distribution()`

### 3. Convergent Route Analysis

Two figures are generated for convergent route analysis:

- **Files**:
    - `convergent_fraction_by_length.{pdf,html}`
    - `convergent_fraction_overall.{pdf,html}`
- **Description**: Analyzes the fraction of convergent routes by length and overall convergent fraction across datasets.
- **Generated by**: `plot_convergent_fraction_by_length()` and `plot_convergent_fraction_overall()`

### 4. Top-K Accuracy Analysis

- **File**: `{dataset_name}_topk_accuracy_subplots.{pdf,html}`
- **Description**: Comparative bar plots showing top-k accuracy metrics for different models and configurations.
- **Features**: Shows accuracy for k values [1, 2, 3, 4, 5, 10]
- **Generated separately** for n1 and n5 datasets

### 5. Route Processing Stages

- **File**: `{dataset_name}_route_processing_stages_{config}.{pdf,html}`
- **Description**: Visualizes different stages of route processing, comparing:
    - Valid routes
    - Processed routes without stock
    - Processed routes with stock
    - True routes

### 6. Accuracy by Route Length

- **File**: `accuracy_by_length_subplots_{config}.{pdf,html}`
- **Description**: Shows top-k accuracy metrics broken down by route length
- **Features**: 
    - Compares performance across different datasets (n1, n5)
    - Shows accuracy for k=1 and k=10

## Usage

To generate these figures, modify the `rerun` dictionary in `paper-figures.py` to specify which figures you want to generate:

```python
rerun = {
    "route-distribution": False,
    "leaf-distribution": False,
    "convergent-fraction": False,
    "topk-accuracy": False,
    "extraction-distribution": True,
    "accuracy-by-length": False,
}
```

Set the corresponding flag to `True` for the figures you want to generate. All figures will be saved in both PDF and HTML formats in the `data/figures/paper` directory.

## Source Code

::: directmultistep.analysis.paper.dataset_analysis
    handler: python
    options:
      show_root_heading: true
      show_source: true

::: directmultistep.analysis.paper.linear_vs_convergent
    handler: python
    options:
      show_root_heading: true
      show_source: true
